<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Biqalawa_dz â€” Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ©</title>

<!-- Cairo font -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap" rel="stylesheet">

<style>
  :root{
    --bg1:#0a0014;
    --accent:#9b4dff;
    --accent2:#ff5a8a;
    --card-bg: rgba(0,0,0,0.45);
  }
  html,body{height:100%;margin:0;font-family:"Cairo",sans-serif;background:radial-gradient(circle at 10% 10%, rgba(155,77,255,0.08), transparent 10%), linear-gradient(180deg,#0b0016,#07000b); color:#fff; -webkit-font-smoothing:antialiased;}
  /* full neon glow background */
  .neon-bg{
    position:fixed;inset:0;z-index:0;pointer-events:none;
    background:
      radial-gradient(600px 400px at 50% 20%, rgba(155,77,255,0.06), transparent 20%),
      radial-gradient(400px 300px at 20% 70%, rgba(0,120,255,0.03), transparent 10%);
    filter:blur(12px);
    mix-blend-mode:screen;
  }

  /* loading splash */
  #splash{
    position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:9999;background:linear-gradient(180deg,rgba(4,0,10,0.95),rgba(8,0,15,0.9));
    flex-direction:column;gap:18px;
  }
  .spinner{
    width:90px;height:90px;border-radius:50%;background:conic-gradient(var(--accent), var(--accent2), transparent);filter:drop-shadow(0 0 20px rgba(155,77,255,0.4));
    animation:spin 2.6s linear infinite;
  }
  @keyframes spin{to{transform:rotate(360deg)}}

  /* main card */
  .wrap{position:relative;z-index:2;min-height:100vh;display:flex;align-items:flex-start;justify-content:center;padding:60px 16px 120px;}
  .card{
    width:360px;max-width:92vw;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.25));
    border-radius:20px;padding:26px;border:1px solid rgba(155,77,255,0.18);box-shadow:0 8px 40px rgba(0,0,0,0.6);
    backdrop-filter: blur(8px);
    text-align:center;
  }

  .logo-wrap{position:relative;margin-top:-90px;margin-bottom:8px;}
  .logo{
    width:170px;height:170px;border-radius:20px;object-fit:cover;border:6px solid rgba(0,0,0,0.6);box-shadow:0 15px 40px rgba(155,77,255,0.25), inset 0 0 40px rgba(155,77,255,0.12);
    transform:translateY(-8px);
  }
  .logo-glow{
    position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:220px;height:220px;border-radius:28px;filter:blur(28px);
    background:radial-gradient(circle at 30% 30%, rgba(155,77,255,0.6), transparent 30%), radial-gradient(circle at 70% 70%, rgba(0,200,255,0.15), transparent 20%);
    z-index:-1;
  }

  h1{margin:8px 0 6px;color:#ff8b6b;font-size:28px;text-shadow:0 6px 20px rgba(255,107,107,0.08);letter-spacing:1px}
  p.desc{color:#e6dff6;margin:6px 0 18px;font-size:15px}

  .btn{display:inline-block;padding:10px 22px;border-radius:28px;background:linear-gradient(90deg,var(--accent2),var(--accent));color:white;text-decoration:none;font-weight:700;box-shadow:0 10px 30px rgba(155,77,255,0.18);transition:transform .18s}
  .btn:hover{transform:translateY(-4px)}
  .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);box-shadow:none;color:#fff;padding:8px 18px}

  /* chat box */
  .chat{
    margin-top:18px;background:linear-gradient(180deg, rgba(10,5,20,0.6), rgba(8,3,18,0.55));border-radius:14px;padding:10px;border:1px solid rgba(155,77,255,0.08);
    box-shadow:0 10px 40px rgba(0,0,0,0.6);
  }
  .messages{max-height:260px;overflow:auto;padding:8px;display:flex;flex-direction:column;gap:8px}
  .msg{align-self:flex-end;max-width:85%;padding:10px 12px;border-radius:12px;background:linear-gradient(180deg, rgba(155,77,255,0.14), rgba(155,77,255,0.08));box-shadow:0 6px 14px rgba(155,77,255,0.04);color:#fff;font-size:14px}
  .msg.other{align-self:flex-start;background:linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.28));border:1px solid rgba(255,255,255,0.02)}
  .msg .time{display:block;opacity:0.6;font-size:11px;margin-top:6px;text-align:left}

  .chat-controls{display:flex;gap:8px;margin-top:10px}
  .chat-input{flex:1;padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:rgba(0,0,0,0.35);color:#fff;}
  .send-btn{padding:10px 12px;border-radius:12px;background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;border:none;font-weight:700}

  footer{position:fixed;bottom:8px;left:0;right:0;text-align:center;color:#bdb3d8;font-size:13px;z-index:2}
  /* responsive */
  @media (max-width:420px){
    .card{width:92%}
    .logo{width:150px;height:150px}
  }
</style>
</head>
<body>

<div class="neon-bg"></div>

<!-- Splash screen -->
<div id="splash">
  <div class="spinner"></div>
  <div style="text-align:center">
    <div style="font-weight:700;font-size:18px;margin-bottom:6px">Biqalawa_dz</div>
    <div style="opacity:0.8">Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„ÙØ§Ø®Ø±â€¦</div>
  </div>
</div>

<div class="wrap">
  <div class="card" role="main">
    <div class="logo-wrap">
      <div class="logo-glow"></div>
      <!-- Logo image from your GitHub repo (raw) -->
      <img id="siteLogo" class="logo" src="https://raw.githubusercontent.com/belamrikatya6/biqalawa_music/main/logo.jpg" alt="Biqalawa logo">
    </div>

    <h1>biqalawa_dz</h1>
    <p class="desc">ØµØ§Ù†Ø¹Ø© Ù…Ø­ØªÙˆÙ‰ Ø£Ù„Ø¹Ø§Ø¨ â€” Ù…Ø­ØªÙˆÙ‰ ØªØ±ÙÙŠÙ‡ÙŠ âš¡ ØªØ§Ø¨Ø¹ÙˆÙ†ÙŠ Ø¹Ù„Ù‰ ØªÙŠÙƒ ØªÙˆÙƒ ğŸ‘‡</p>

    <a class="btn" href="https://www.tiktok.com/@biqalawa_dz?_t=ZS-90k8RqhtpP0&_r=1" target="_blank" rel="noopener">ØªØ§Ø¨Ø¹ÙˆÙ†ÙŠ Ø¹Ù„Ù‰ ØªÙŠÙƒ ØªÙˆÙƒ</a>

    <!-- Chat -->
    <div class="chat" aria-live="polite">
      <div style="display:flex;align-items:center;justify-content:space-between;margin:8px 6px">
        <strong>Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø²ÙˆØ§Ø± (Ø¹Ø§Ù…Ø©)</strong>
        <span style="font-size:12px;opacity:0.7">Ù…Ø±Ø¦ÙŠ Ù„ÙƒÙ„ Ø§Ù„Ø²ÙˆØ§Ø±</span>
      </div>

      <div id="messages" class="messages" aria-label="Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„"></div>

      <div class="chat-controls">
        <input id="msgInput" class="chat-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." aria-label="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©">
        <button id="sendBtn" class="send-btn">Ø¥Ø±Ø³Ø§Ù„</button>
      </div>
    </div>

  </div>
</div>

<footer>Â© biqalawa_dz 2025 Â· ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©</footer>

<!-- Audio (Ù…ÙˆØ³ÙŠÙ‚Ù‰) -->
<audio id="bgAudio" loop playsinline>
  <source src="https://raw.githubusercontent.com/belamrikatya6/biqalawa_music/main/music.mp3" type="audio/mpeg">
</audio>

<!-- Firebase + Firestore (Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø¹ÙŠØ§Ø±ÙŠØ© Ø¹Ø¨Ø± ES modules) -->
<script type="module">
  // === Firebase config: Ø§Ø³ØªØ®Ø¯Ù…Øª Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„ØªÙŠ Ø£Ø¹Ø·ÙŠØªÙÙ‡Ø§ Ø³Ø§Ø¨Ù‚Ø§Ù‹ ===
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp, limit } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBf74thAqGYnuCw5WK4yR7UIkaJyJVsrfU",
    authDomain: "biqalawa-36a05.firebaseapp.com",
    projectId: "biqalawa-36a05",
    storageBucket: "biqalawa-36a05.firebasestorage.app",
    messagingSenderId: "320644743211",
    appId: "1:320644743211:web:a585f4e38e593748eeea6e",
    measurementId: "G-H3PKM74KK7"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
  const splash = document.getElementById('splash');
  const audio = document.getElementById('bgAudio');
  const messagesEl = document.getElementById('messages');
  const input = document.getElementById('msgInput');
  const sendBtn = document.getElementById('sendBtn');

  // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ø°ÙƒÙŠÙ‹Ø§:
  // 1) Ù†Ø¨Ø¯Ø£ Ø¨Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ù…ÙƒØªÙˆÙ…Ø© (Ø¨Ø¹Ø¶ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª ØªØ³Ù…Ø­ Ø¨Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª muted)
  // 2) Ø¥Ø°Ø§ Ù†Ø¬Ø­ØªØŒ Ù†Ø±ÙØ¹ Ø§Ù„ØµÙˆØª Ø¨Ø¹Ø¯ ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£ÙˆÙ„
  audio.muted = true;
  audio.volume = 0.25;
  audio.play().catch(()=>{ /* Ù…ØªØµÙØ­ Ù…Ù†Ø¹ Ø§Ù„ØªØ´ØºÙŠÙ„ */ });

  const enableSoundOnInteraction = () => {
    audio.muted = false;
    audio.volume = 0.45; // Ù…Ø³ØªÙˆÙ‰ Ù…ØªÙˆØ³Ø·
    audio.play().catch(()=>{});
    // Ù†Ø´ÙŠÙ„ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ø¨Ø¹Ø¯ Ø£ÙˆÙ„ ØªÙØ§Ø¹Ù„
    window.removeEventListener('click', enableSoundOnInteraction);
    window.removeEventListener('touchstart', enableSoundOnInteraction);
  };
  window.addEventListener('click', enableSoundOnInteraction, { once:true });
  window.addEventListener('touchstart', enableSoundOnInteraction, { once:true });

  // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© / 800ms
  window.addEventListener('load', () => {
    setTimeout(()=>{ splash.style.display='none'; }, 800);
  });

  // ---------- Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø­ÙŠØ© (Firestore) ----------
  // collection name
  const col = collection(db, 'public_chat');

  // Ø¥Ø¸Ù‡Ø§Ø± Ø¢Ø®Ø± 100 Ø±Ø³Ø§Ù„Ø© (Ù…Ø±ØªØ¨Ø© Ø²Ù…Ù†ÙŠØ§Ù‹)
  const q = query(col, orderBy('createdAt'), limit(100));

  // Ø§Ø³ØªÙ…Ø¹ Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ø­ÙŠØ©
  onSnapshot(q, snapshot => {
    messagesEl.innerHTML = ''; // Ù†Ù†Ø¸Ù Ø§Ù„Ù‚Ø§ÙŠÙ…Ø© Ø«Ù… Ù†Ø¹Ø±Ø¶
    snapshot.forEach(doc => {
      const data = doc.data();
      const isMe = false; // ÙƒÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØªØ¹Ø±Ø¶ ÙƒÙ€ other Ø£Ùˆ you - Ù‡Ù†Ø§ Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„
      const msg = document.createElement('div');
      msg.className = 'msg ' + (isMe? 'me' : 'other');
      // Ù†Øµ Ù…Ø¹ Ø§Ù„Ù…Ø±Ø³Ù„ ÙˆØ§Ù„ØªÙˆÙ‚ÙŠØª
      const sender = data.name ? data.name : 'Ø²Ø§Ø¦Ø±';
      const text = (data.text||'').replace(/</g,'&lt;');
      msg.innerHTML = `<strong style="display:block;margin-bottom:6px;font-size:13px">${sender}</strong>
                       <div>${text}</div>
                       <span class="time">${data.createdAt && data.createdAt.toDate ? data.createdAt.toDate().toLocaleString() : ''}</span>`;
      messagesEl.appendChild(msg);
    });
    // ØªÙ…Ø±ÙŠØ± Ù„Ø£Ø³ÙÙ„
    messagesEl.scrollTop = messagesEl.scrollHeight;
  }, err => {
    console.error('Firestore listen error:', err);
    const warn = document.createElement('div');
    warn.style.opacity = '0.7';
    warn.style.fontSize = '13px';
    warn.style.padding = '8px';
    warn.innerText = 'ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© â€” ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯ Firestore ÙÙŠ Firebase.';
    messagesEl.appendChild(warn);
  });

  // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Firestore
  async function sendMessage(){
    const text = input.value.trim();
    if(!text) return;
    // Ø§Ø³Ù… Ù…Ø±Ø³Ù„ Ø§ÙØªØ±Ø§Ø¶ÙŠ â€” ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ±Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹
    const name = 'Ø²Ø§Ø¦Ø±';
    try{
      await addDoc(col, { text, name, createdAt: serverTimestamp() });
      input.value = '';
    }catch(e){
      console.error('send error', e);
      alert('ØªØ¹Ø°Ù‘Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©. ØªØ£ÙƒØ¯ÙŠ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase (Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©/Ø§Ù„ÙƒØªØ§Ø¨Ø©).');
    }
  }

  sendBtn.addEventListener('click', sendMessage);
  input.addEventListener('keydown', (e) => { if(e.key === 'Enter') sendMessage(); });

</script>

</body>
      </html>
