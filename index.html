<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Biqalawa_dz — صفحة فخمة</title>

<!-- واجهة وخطوط -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg1:#070014;
    --accent:#9b4dff;
    --accent-2:#ff5f8a;
    --card: rgba(255,255,255,0.04);
    --glass: rgba(255,255,255,0.03);
    --text:#f3f3f6;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:'Cairo',sans-serif;background: radial-gradient(circle at 10% 10%, #0b0020 0%, #05000a 55%);color:var(--text);-webkit-font-smoothing:antialiased}
  .center {
    min-height:100vh; display:flex; align-items:center; justify-content:center; padding:28px;
  }

  .card {
    width:100%; max-width:920px; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    border-radius:20px; padding:28px; box-shadow: 0 20px 50px rgba(0,0,0,0.6); position:relative; overflow:hidden;
    border: 1px solid rgba(155,77,255,0.08);
  }

  /* خلفية متلألئة */
  .bg-glow {
    position:absolute; inset:-30% -10% auto auto; width:140%; height:140%; pointer-events:none;
    background: radial-gradient(circle at 20% 20%, rgba(155,77,255,0.18), transparent 15%), radial-gradient(circle at 80% 80%, rgba(0,180,255,0.06), transparent 20%);
    filter: blur(45px); transform: rotate(10deg);
  }

  .header { display:flex; gap:18px; align-items:center; margin-bottom:18px; z-index:2; position:relative; }
  .logo {
    width:120px; height:120px; border-radius:16px; overflow:hidden; border:4px solid rgba(255,255,255,0.06);
    box-shadow: 0 10px 30px rgba(155,77,255,0.12), inset 0 -6px 20px rgba(0,0,0,0.5);
    background: linear-gradient(135deg,#2b004b,#120018);
  }
  .logo img{width:100%;height:100%;object-fit:cover; display:block}

  .title {font-size:28px; font-weight:700; color:var(--accent-2); text-shadow: 0 4px 18px rgba(155,77,255,0.12);}
  .subtitle {margin-top:6px;color:#d7cfe8; font-size:14px}

  .actions {margin-left:auto; display:flex; gap:10px; align-items:center}
  .btn {background: linear-gradient(90deg,var(--accent), #ff6b8b); color:white; padding:10px 16px; border-radius:999px; text-decoration:none; font-weight:700; box-shadow:0 8px 30px rgba(155,77,255,0.16); border:none}
  .small {padding:8px 12px; font-size:14px; background:rgba(255,255,255,0.03); border-radius:10px; color:#eee; border:1px solid rgba(255,255,255,0.03)}

  .main-grid { display:grid; grid-template-columns: 1fr 360px; gap:18px; align-items:start; z-index:2; position:relative;}
  @media (max-width:900px){ .main-grid{grid-template-columns: 1fr; } .logo{width:96px;height:96px} }

  /* يسار: المحتوى الرئيسي */
  .left { padding: 18px; background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:12px; min-height:300px; }

  .player { display:flex; gap:12px; align-items:center }
  .play-btn { width:56px; height:56px; border-radius:12px; display:grid; place-items:center; font-size:22px; background:linear-gradient(180deg,var(--accent), #6b2fff); cursor:pointer; box-shadow: 0 8px 30px rgba(155,77,255,0.18); border:none; color:white}
  .track {flex:1}
  .track h3{margin:0;font-size:18px;color:#fff}
  .track p{margin:4px 0 0;color:#d6cfe6}

  .stats { display:flex; gap:12px; margin-top:14px; }
  .stat { background:var(--glass); padding:12px; border-radius:10px; flex:1; text-align:center; border:1px solid rgba(255,255,255,0.02) }
  .stat strong{display:block;font-size:20px;color:var(--accent)}

  /* يمين: دردشة */
  .chat-wrap { background: linear-gradient(180deg, rgba(0,0,0,0.18), rgba(0,0,0,0.12)); border-radius:12px; padding:12px; min-height:420px; display:flex; flex-direction:column; gap:10px; border:1px solid rgba(155,77,255,0.06) }
  .messages { overflow:auto; flex:1; padding:6px; display:flex; flex-direction:column; gap:8px }
  .msg { display:flex; gap:8px; align-items:flex-end; }
  .msg .avatar { width:36px;height:36px;border-radius:10px;background:linear-gradient(180deg,var(--accent), #3b0a67);display:grid;place-items:center;color:white;font-weight:700}
  .bubble { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:10px 12px; border-radius:12px; max-width:100%; color:#fff; border:1px solid rgba(255,255,255,0.02) }
  .meta { font-size:12px; color:#cfc6ea; margin-top:4px}
  .chat-input { display:flex; gap:8px; align-items:center }
  .chat-input input { flex:1; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background: rgba(0,0,0,0.2); color:var(--text) }
  .send { padding:10px 14px; border-radius:10px; background:var(--accent); color:white; border:none; font-weight:700; cursor:pointer }

  footer { margin-top:18px; text-align:center; color:#bfb7cf; font-size:13px}
</style>
</head>
<body>

<div class="center">
  <div class="card">

    <div class="bg-glow" aria-hidden></div>

    <div class="header">
      <div class="logo" title="Baclawah DZ Logo">
        <!-- اضبطي رابط الصورة هنا -->
        <img id="brand-logo" src="https://raw.githubusercontent.com/belamrikatya6/biqalawa_music/main/logo.jpg" alt="logo">
      </div>

      <div>
        <div class="title">Biqalawa_dz</div>
        <div class="subtitle">صفحة رسمية · ترفيهية · دردشة مباشرة · موسيقى</div>
      </div>

      <div class="actions">
        <button id="toggleSound" class="btn">تشغيل الموسيقى</button>
        <a class="small" href="https://www.tiktok.com" target="_blank" rel="noopener">TikTok</a>
      </div>
    </div>

    <div class="main-grid">

      <div class="left">
        <div class="player">
          <button id="playBtn" class="play-btn">▶</button>
          <div class="track">
            <h3>موسيقى البيقلاوة</h3>
            <p>تشغيل تلقائي (قد يحتاج لمس/نقرة في الهواتف)</p>
          </div>
        </div>

        <div class="stats">
          <div class="stat">
            زوار الآن
            <strong id="visitorCount">0</strong>
            <div style="font-size:12px;color:#d9cfe7">زائر</div>
          </div>
          <div class="stat">
            رسائل
            <strong id="msgCount">0</strong>
            <div style="font-size:12px;color:#d9cfe7">مجموع الرسائل</div>
          </div>
        </div>

        <!-- إضافة محتوى أو معرض أو مميزات -->
        <div style="margin-top:14px; background:linear-gradient(180deg, rgba(255,255,255,0.01),transparent); padding:12px; border-radius:10px; color:#e9e0ff">
          <h4 style="margin:0 0 8px">ميزات الصفحة</h4>
          <ul style="margin:0 0 0 16px; color:#d6cfe6">
            <li>دردشة عامة في الوقت الحقيقي (Firebase)</li>
            <li>موسيقى خلفية (mp3 من GitHub)</li>
            <li>صورة لوجو متطابقة ومؤثرة</li>
            <li>واجهة متجاوبة متحركة</li>
          </ul>
        </div>
      </div>

      <aside class="chat-wrap">
        <div style="display:flex; justify-content:space-between; align-items:center">
          <strong>دردشة الجمهور</strong>
          <small style="color:#cdbfe8">متاحة للعامة</small>
        </div>

        <div id="messages" class="messages" aria-live="polite"></div>

        <div style="display:flex; gap:8px;">
          <input id="nameInput" placeholder="اسمك (مثال: زائر123)" value="">
          <button id="nameBtn" class="small">احفظ الاسم</button>
        </div>

        <div class="chat-input">
          <input id="msgInput" placeholder="اكتب رسالة..." autocomplete="off">
          <button id="sendBtn" class="send">إرسال</button>
        </div>

      </aside>

    </div>

    <footer>© Biqalawa_dz — الصفحة رسمية · صممت بواسطة المالك</footer>
  </div>
</div>

<!-- ملف الصوت (من GitHub raw) -->
<audio id="bg-music" loop playsinline>
  <source src="https://raw.githubusercontent.com/belamrikatya6/biqalawa_music/main/music.mp3" type="audio/mpeg">
  المتصفح لا يدعم تشغيل الصوت
</audio>

<!-- --------------- Firebase SDK (compat: أسهل للتضمين في صفحة HTML) --------------- -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
/* ====== ضع هنا إعدادات Firebase الخاصة بمشروعك (استبدلي القيم بما هو في Console) ====== */
const firebaseConfig = {
  apiKey: "AIzaSyBf74thAqGYnuCw5WK4yR7UIkaJyJVsrfU",
  authDomain: "biqalawa-36a05.firebaseapp.com",
  databaseURL: "https://biqalawa-36a05-default-rtdb.firebaseio.com", // <-- عدلي هذا للـ databaseURL الخاص بك
  projectId: "biqalawa-36a05",
  storageBucket: "biqalawa-36a05.appspot.com",
  messagingSenderId: "320644743211",
  appId: "1:320644743211:web:a585f4e38e593748eeea6e",
  measurementId: "G-H3PKM74KK7"
};
/* ================================================================================== */

/* تهيئة Firebase */
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* عناصر DOM */
const messagesEl = document.getElementById('messages');
const msgInput = document.getElementById('msgInput');
const sendBtn = document.getElementById('sendBtn');
const nameInput = document.getElementById('nameInput');
const nameBtn = document.getElementById('nameBtn');
const visitorCountEl = document.getElementById('visitorCount');
const msgCountEl = document.getElementById('msgCount');

const playBtn = document.getElementById('playBtn');
const toggleSound = document.getElementById('toggleSound');
const audio = document.getElementById('bg-music');

/* اسم الزائر (محلي) */
let myName = localStorage.getItem('biqa_name') || ('زائر' + Math.floor(Math.random()*1000));
nameInput.value = myName;

/* حفظ الاسم */
nameBtn.addEventListener('click', () => {
  const v = nameInput.value.trim();
  if(v) { myName = v; localStorage.setItem('biqa_name', v); alert('تم حفظ الاسم: ' + v); }
});

/* تشغيل/إيقاف الصوت */
function updatePlayBtn(){
  toggleSound.textContent = audio.paused ? 'تشغيل الموسيقى' : 'إيقاف الموسيقى';
  playBtn.textContent = audio.paused ? '▶' : '❚❚';
}
toggleSound.addEventListener('click', () => {
  if(audio.paused){ audio.play().catch(()=>{}); } else audio.pause();
  updatePlayBtn();
});
playBtn.addEventListener('click', ()=> { if(audio.paused) audio.play().catch(()=>{}); else audio.pause(); updatePlayBtn(); });

/* محاولة التشغيل التلقائي (قد يرفضه الهاتف — المستعرض) */
window.addEventListener('load', () => {
  audio.play().then(()=>updatePlayBtn()).catch(()=>{ /* إذا رفض المتصفح، سننتظر تفاعل المستخدم */ });
});

/* تفعيل التشغيل بعد أول تفاعل للموبايل */
document.body.addEventListener('click', ()=>{ audio.play().catch(()=>{}); updatePlayBtn(); }, { once:true });
document.body.addEventListener('touchstart', ()=>{ audio.play().catch(()=>{}); updatePlayBtn(); }, { once:true });

/* إرسال رسالة */
sendBtn.addEventListener('click', sendMessage);
msgInput.addEventListener('keydown', (e) => { if(e.key === 'Enter') sendMessage(); });

function sendMessage(){
  const text = msgInput.value.trim();
  if(!text) return;
  const item = {
    name: myName,
    text,
    ts: Date.now()
  };
  // دفع الرسالة إلى المسار /public/messages
  db.ref('public/messages').push(item).then(()=>{
    msgInput.value = '';
  }).catch(err => console.error('db push error', err));
}

/* عرض رسالة داخل الـ DOM */
function appendMessage(msgData){
  const el = document.createElement('div');
  el.className = 'msg';
  const avatar = document.createElement('div');
  avatar.className = 'avatar';
  avatar.textContent = (msgData.name || 'زائر').slice(0,2);
  const bubbleWrap = document.createElement('div');
  const bubble = document.createElement('div');
  bubble.className = 'bubble';
  bubble.textContent = msgData.text;
  const meta = document.createElement('div');
  meta.className = 'meta';
  const d = new Date(msgData.ts || Date.now());
  meta.textContent = (msgData.name || 'زائر') + ' · ' + d.toLocaleTimeString();
  bubbleWrap.appendChild(bubble);
  bubbleWrap.appendChild(meta);
  el.appendChild(avatar);
  el.appendChild(bubbleWrap);
  messagesEl.appendChild(el);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

/* الاستماع للرسائل الجديدة (الزمن الحقيقي) */
db.ref('public/messages').limitToLast(200).on('child_added', snapshot => {
  const data = snapshot.val();
  appendMessage(data);
  // تحديث عداد الرسائل
  db.ref('public/messages').once('value').then(snap => {
    const count = snap.numChildren() || 0;
    msgCountEl.textContent = count;
  });
});

/* عداد الزوار (بسيط) — سنستخدم node في المسار /public/visitors مع القيمة الحالية وزمن آخر زيارة */
const myVisitorKey = db.ref('public/visitors').push().key;
function updateVisitor() {
  const vref = db.ref('public/visitors/' + myVisitorKey);
  vref.set({ name: myName, ts: Date.now() });
  // سنجدد وجودنا كل 25 ثانية
  setTimeout(updateVisitor, 25000);
}
updateVisitor(); // ابدأ وجود الزائر

/* إزالة الزيارة عند إغلاق الصفحة (قد لا يعمل دائمًا على موبايل) */
window.addEventListener('beforeunload', () => {
  db.ref('public/visitors/' + myVisitorKey).remove();
});

/* استماع لتغير زوار وعددهم */
db.ref('public/visitors').on('value', snap => {
  visitorCountEl.textContent = snap.numChildren() || 0;
});

/* ---------- نصائح أمان وتهيئة Firebase ---------- */
/*
1) تذكري تعديل قواعد Realtime Database في Firebase Console:
   - لتجربة سريعة (غير آمنة): 
     {
       "rules": {
         "public": {
           ".read": true,
           ".write": true
         }
       }
     }
   - بعد التجربة، عدّلي القواعد لتقييد الكتابة للمستخدمين أو تفعيل مصادقة.
2) المسارات المستخدمة:
   - public/messages   => الرسائل العامة
   - public/visitors   => عداد الزوار
3) إذا أردت أسماء زوار موثوقة أكثر، فعّلي Firebase Authentication (مثلاً Google sign-in).
*/

</script>
</body>
  </html>
